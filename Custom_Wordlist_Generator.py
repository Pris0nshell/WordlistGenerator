import os
import time
import subprocess
import shutil
from datetime import datetime

# New ASCII Art Loading Banner with Generator & Smoke
ASCII_ART = r"""
      @@@@@@@                               @@@        
                                              @@@@@@@@@@@@                              @@@@@       
                                        @@@@@@@@@@%%@@@@@                @@@@@@@     @@@@ @@@@@@    
                                     @@@@@@@@#*+++%@@@@                @@@@@@@@@@@   @@@@@@@@@@@    
                                    @@@@%+++++==%@@@@               @@@@@%+@@@+@@@@@@   @@@@@       
                                   @@@@++++===#@@@@       @@@      @@@@@++*@@@*=+@@@@@   @@@        
                                  @@@@*+++==+%@@@@        @@@@    @@@@@@@@@@@@@@@@@@@@              
                                 @@@@#+++====#@@@@    @@@@@  @@@@ @@@@*#@@@**#@@@*+@@@              
                                 @@@#+++======*@@@@   @@@@@@@@@@@ @@@@+=@@@***@@%++@@@              
                                @@@#+++========+@@@@      @@@@    @@@@+=@@@***@@%++@@@              
                               @@@@@@@@@%+===%@@@@@@@     @@@@    @@@@+=@@@***@@%++@@@              
                              @@@@@@@@@@#++++#@@@@@@@@          @@@@@@@@@@@@@@@@@@@@@@@@@           
                             @@@@****++++++++++++++@@@@         @@@@@###############@@@@@           
                           @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@        @@@@@+-----------+@@@@@            
                      @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@     @@@@@*===----*@@@@@              
                  @@@@@@@@%#*+++++++++++++++++++++++++++*%@@@@@@@@@  @@@@@@@@@@@@@@@                
             @@@@@@@@@#*++++++===============================*%@@@@@@@@@@@#****@@@                  
        @@@@@@@@@%*+++++++=======================================+#@@@@@@@=:::-@@@                  
    @@@@@@@@%#*++++++=================================================*@@@=:::-@@@                  
    @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@*++++@@@                  
    @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@                  
                     @@@#--+@@#---#@@=::#@@=:::#@@-::=@@#--=@@@@        @@@#=#@@@                   
                     @@@=--+@@#---#@@=*@@@+::::*@@:::=@@#---%@@@        @@@*-#@@@                   
                     @@@+--+@@#----::*@@@=:::::::::::=@@#---@@@@        @@@*-#@@@                   
           @@@@@@@@@@@@@@#=+@@#----:::+@@@%-:::::::::=@@#-+%@@@@@@@@@@@@@@@*-#@@@                   
          @@@@@@@@@@@@@@@@@@@@#----:=#%%@@@%%%#*-::::=@@@@@@@@@@@@@@@@@@@@@*-#@@@                   
          @@@@#+++++=====+*%@@#---%@@@@@@@@@@@@@@@=::=@@@#*==========+%@@@@*-#@@@                   
           @@@@@*++++======+@@#--@@@+:.       .-%@@*:=@@#===========#@@@@@@*-#@@@                   
             @@@@@*++++====+@@%-*@@= .+*-:.:+*: :%@%-+@@#=========#@@@@ @@@*--=@                    
               @@@@%+++++==+@@@+*@@- -@@@@@@@@# :%@%=@@@#=======*@@@@@  @@@*---                     
                 @@@@%+++++*@@@@@@@-   .-==-:.  :%@@@@@@#=====*@@@@@    @@@*-#@@@                   
                  @@@@@#+++*@@@@@@%.            .*@@@@@@#===+@@@@@      @@@*-#@@@                   
                    @@@@@*+*@@*.....                 -@@#=+%@@@@        @@@*-#@@@                   
                      @@@@@#@@*.....                 -@@%#@@@@          @@@*-#@@@                   
                   @@@@@@@@@@@*.....                 -@@@@@@@@@@@       @@@*-#@@@                   
               @@@@@@@@%**#@@@*.....                 -@@@@**#@@@@@@@@   @@@*-#@@@                   
           @@@@@@@@%*******#@@*.....                 -@@%****+++#%@@@@@@@@@*-#@@@                   
        @@@@@@@%*******++++*@@#.....                 -@@%***++++++++*%@@@@@*-#@@@                   
       @@@@%*******+++++++++@@%:.....               .#@@#***++++++++++++#@@*-#@@@                   
     @@@@%*******+++++++++++#@@#......             .+@@%***+++++++++++++#@@*-#@@@                   
    @@@@#******++++++++++++++#@@@-.....           .+@@@****+++++++++++++#@@*-#@@@                   
    @@@%******++++++++++++++++#@@@-.....         .#@@@****++++++++++++++#@@*-#@@@                   
    @@@#******+++++++++++++++++*@@@-.....       :%@@%****+++++++++++++++#@@*-#@@@                   
    @@@#******+++++++++++++++++++@@@*.....     :%@@%****+++++++++++++++#@@@@%@@@@                   
    @@@#******++++++++++++++++++++%@@*.....  .:@@@#****++++++++++++++#@@@@@@@@@@@@@                 
    @@@#******+++++++++++++++++*#%@@@@#......=@@@@@%#*+++++++++++++++%@@+--::::-%@@@                
    @@@@@@@@@@@@@@@#+++#@@@@@@@@@@@**@@@:...+@@%+%@@@@@@@@@@@@@@@@@@@@@@@#-:::::=@@@@               
     @@@@@@%%%%%%%#=====#%%%%%%@@%-::+@@%-.*@@%:::+@@%%%%%%%%%%%%%%%%@@@#--:::::=@@@@               
        @@@++++++=============+@@%-:::=@@@@@@*::::+@@*===============#@@%=-:::::=@@@@               
        @@@++++++=============+@@%-:::::%@@@*:::::+@@*===============*@@@*-:::::=@@@@               
        @@@++++++=============+@@%-::::::-=:::::::+@@*===============%@@=--:::::=@@@@               
        @@@++++++=============+@@%-:::::::::::::::+@@*===============*@@@#-:::::=@@@@               
        @@@++++++=============+@@%-:::::::::::::::+@@*===============%@@#=-:::::*@@@               
        @@@@%%%%%%%%%%%%%%%%%%%@@@%%%%%%%%%%%%%%%%%@@@%%%%%%%%%%%%%%%@@@@%%%%%@@@@@                 
        @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@                   

+==================================================================================================================+
|                                                                                                                  |
|     ____                _           _      _                ____       _      ___        ____  _          _ _    |
|    / ___|_ __ ___  __ _| |_ ___  __| |    | |__  _   _     |  _ \ _ __(_)___ / _ \ _ __ / ___|| |__   ___| | |   |
|   | |   | '__/ _ \/ _` | __/ _ \/ _` |    | '_ \| | | |    | |_) | '__| / __| | | | '_ \\___ \| '_ \ / _ \ | |   |
|   | |___| | |  __/ (_| | ||  __/ (_| |    | |_) | |_| |    |  __/| |  | \__ \ |_| | | | |___) | | | |  __/ | |   |
|    \____|_|  \___|\__,_|\__\___|\__,_|    |_.__/ \__, |    |_|   |_|  |_|___/\___/|_| |_|____/|_| |_|\___|_|_|   |
|                                                  |___/                                                           |
|                                                                                                                  |
+==================================================================================================================+
"""

# Display ASCII Art
print(ASCII_ART)

# Check if Hashcat is installed
def check_hashcat():
    if not shutil.which("hashcat"):
        print("Error: Hashcat is not installed. Please install Hashcat and try again.")
        exit(1)

# Get user input
word = input("Enter the base word: ").strip()

# Define variables
current_date = datetime.now().strftime("%Y-%m-%d")
WORDLIST_FILE = f"{word}_custom_wordlist_{current_date}.txt"  # New filename format
RULES_FILE = "/home/kali/Desktop/applications/custom/OneRuleToRuleThemAll.rule"
TEMP_FILE = "input_word.txt"
ENCODING_FIX_FILE = "generated_wordlist_utf8.txt"
YEARS = ["2020","2021","2022","2023", "2024", "2025", "2026", "2027", "2028","2029", "2030"]
SPECIAL_CHARS = ["@", "#", "!", "$"]

# Check if rule file exists
if not os.path.isfile(RULES_FILE):
    print(f"Error: Rule file '{RULES_FILE}' not found. Ensure it's in the correct location.")
    exit(1)

# Generate variations
print("\nüí® Generating word variations... (The generator is smoking!)\n")
time.sleep(1)

with open(TEMP_FILE, "w", encoding="utf-8") as file:
    for year in YEARS:
        for char in SPECIAL_CHARS:
            file.write(f"{word}{char}{year}\n")
            file.write(f"{word.capitalize()}{char}{year}\n")

# Run Hashcat to generate mutations
print("\n‚ö° Running Hashcat to create additional mutations...\n")
try:
    subprocess.run(["hashcat", "--stdout", "-r", RULES_FILE, TEMP_FILE], stdout=open(WORDLIST_FILE, "w"), check=True)
except subprocess.CalledProcessError:
    print("‚ùå Error: Hashcat failed to generate the wordlist.")
    os.remove(TEMP_FILE)
    exit(1)

# Convert to UTF-8 encoding
print("\nüîß Fixing encoding issues...\n")
subprocess.run(["iconv", "-f", "UTF-8", "-t", "UTF-8//IGNORE", WORDLIST_FILE, "-o", ENCODING_FIX_FILE])
os.replace(ENCODING_FIX_FILE, WORDLIST_FILE)

# Cleanup
os.remove(TEMP_FILE)

# Count the number of lines in the wordlist
with open(WORDLIST_FILE, "r", encoding="utf-8") as file:
    line_count = sum(1 for line in file)

# Format the line count with commas
line_count_formatted = f"{line_count:,}"

# Completion message with line count
print(f"\n‚úÖ Wordlist generated successfully: {WORDLIST_FILE}")
print(f"Total lines generated: {line_count_formatted}\n")
